{-
  Id: urn:ubideco:stl:2nWgjeSMhVE2mKgC7WyE5Dn8a6tZJDMoNugDWdc4vcZZ#spring-moral-almanac
  Name: RGB
  Version: 0.1.0
  Description: Consensus layer for RGB smart contracts
  Author: Dr Maxim Orlovsky <orlovsky@lnp-bp.org>
  Copyright (C) 2023-2024 LNP/BP Standards Association. All rights reserved.
  License: Apache-2.0
-}

@context
typelib RGB

import BPCore#c8Tnib31q1p7szyPukEGDoQzJQ5qJwPCn5uZCHUXzB9#cupid-metro-warning
  use TapretNodePartner#iceberg-poker-active
  use ExplicitSealTxid#antenna-darwin-emotion
  use TapretProof#forum-paint-tunnel
  use TapretPathProof#stage-element-update
  use Method#trilogy-tahiti-valid
  use TapretRightBranch#basket-prelude-bridge
  use BlindSealTxPtr#austria-icon-waiter
  use OpretProof#segment-ambient-totem
  use SecretSeal#santana-domingo-needle
  use AnchorMerkleProofOpretProof#mammal-ethnic-crown
  use BlindSealTxid#kimono-golf-price
  use TxPtr#strange-source-father
  use AnchorMerkleProofTapretProof#forward-chemist-panda

import CommitVerify#57sPvZcwQaziec3ux249XoCMhziQpKB8Yw99U5oRwfqW#deluxe-safari-random
  use MerkleHash#culture-metro-modular
  use StrictHash#cheese-final-locate
  use MerkleProof#labor-hilton-magenta

import StrictTypes#5teCJyjMWaxbQK8vdga2soWh2U7waERS3ev8KHShJcgv#trumpet-scratch-pelican
  use VariantName#snow-gray-extreme
  use Primitive#hobby-cable-puzzle
  use VariantInfoSemId#clone-panama-guru
  use UnnamedFieldsSemId#hippie-world-sandra
  use NamedFieldsSemId#jordan-kiwi-nickel
  use FieldSemId#speed-patriot-gallery
  use SemId#cargo-plasma-catalog
  use Ident#connect-fragile-exile
  use Sizing#canoe-gordon-amazon
  use EnumVariants#correct-dream-albert
  use TypeSystem#panel-data-lazarus
  use FieldName#orient-spell-talent
  use TySemId#kimono-catalog-mango
  use Variant#textile-cowboy-dragon
  use UnionVariantsSemId#iceberg-road-crack

import AluVM#DVtm25LRKU4TjbyZmVxPhvCmctZ6vKkPKqfpU2QsDNUo#exodus-axiom-tommy
  use LibSite#mission-papa-mercy
  use LibId#rebel-factor-rodeo

import Std#DzTvt9gGhPUKD8Dkkjk9PDBhkJ4gtWxXWQjxnmUYLNrs#voyage-kimono-disco
  use Bool#laser-madam-maxwell
  use AlphaNumLodash#north-sound-salsa

import Bitcoin#HX2UBak8vPsTokug1DGMDvTpzns3xUdwZ7QJdyt4qBA9#speed-atlanta-trilogy
  use Vout#chrome-robin-gallop
  use ScriptBytes#maestro-source-jackson
  use TapNodeHash#crash-culture-jamaica
  use LeafScript#brenda-round-micro
  use Txid#cowboy-diego-betty
  use InternalPk#meter-nerve-chicken
  use LeafVer#tunnel-lagoon-cowboy
  use XOnlyPk#evident-finance-promo


@mnemonic(banana-mouse-plaster)
data AltLayer1         : liquid#1


@mnemonic(salmon-taxi-ohio)
data AltLayer1Set      : {AltLayer1 ^ ..0xff}

@mnemonic(soviet-arsenal-complex)
data AluScript         : libs {AluVM.LibId -> ^ ..0xff [Byte]}, entryPoints {[Byte ^ 3] -> AluVM.LibSite#mission-papa-mercy}

@mnemonic(aurora-blast-brown)
data AnchorSet         : tapret#1 BPCore.AnchorMerkleProofTapretProof#forward-chemist-panda
                       | opret BPCore.AnchorMerkleProofOpretProof#mammal-ethnic-crown
                       | dual (tapret BPCore.AnchorMerkleProofTapretProof#forward-chemist-panda, opret BPCore.AnchorMerkleProofOpretProof#mammal-ethnic-crown)

@mnemonic(verbal-slow-lemon)
data AnchoredBundle    : anchor XChainAnchorSet, bundle TransitionBundle

@mnemonic(buzzer-pattern-craft)
data AssetTag          : [Byte ^ 32]

@mnemonic(police-castle-fractal)
data AssignRevealedAttachBlindSealTxPtr : confidential (seal XChainSecretSeal, state ConcealedAttach)
                       | confidentialState (seal XChainBlindSealTxPtr, state ConcealedAttach)
                       | confidentialSeal (seal XChainSecretSeal, state RevealedAttach)
                       | revealed (seal XChainBlindSealTxPtr, state RevealedAttach)

@mnemonic(parker-locate-madrid)
data AssignRevealedAttachBlindSealTxid : confidential (seal XChainSecretSeal, state ConcealedAttach)
                       | confidentialState (seal XChainBlindSealTxid, state ConcealedAttach)
                       | confidentialSeal (seal XChainSecretSeal, state RevealedAttach)
                       | revealed (seal XChainBlindSealTxid, state RevealedAttach)

@mnemonic(fabric-exotic-road)
data AssignRevealedDataBlindSealTxPtr : confidential (seal XChainSecretSeal, state ConcealedData)
                       | confidentialState (seal XChainBlindSealTxPtr, state ConcealedData)
                       | confidentialSeal (seal XChainSecretSeal, state RevealedData)
                       | revealed (seal XChainBlindSealTxPtr, state RevealedData)

@mnemonic(iron-design-king)
data AssignRevealedDataBlindSealTxid : confidential (seal XChainSecretSeal, state ConcealedData)
                       | confidentialState (seal XChainBlindSealTxid, state ConcealedData)
                       | confidentialSeal (seal XChainSecretSeal, state RevealedData)
                       | revealed (seal XChainBlindSealTxid, state RevealedData)

@mnemonic(avatar-house-ammonia)
data AssignRevealedValueBlindSealTxPtr : confidential (seal XChainSecretSeal, state ConcealedFungible)
                       | confidentialState (seal XChainBlindSealTxPtr, state ConcealedFungible)
                       | confidentialSeal (seal XChainSecretSeal, state RevealedFungible)
                       | revealed (seal XChainBlindSealTxPtr, state RevealedFungible)

@mnemonic(popular-vista-urgent)
data AssignRevealedValueBlindSealTxid : confidential (seal XChainSecretSeal, state ConcealedFungible)
                       | confidentialState (seal XChainBlindSealTxid, state ConcealedFungible)
                       | confidentialSeal (seal XChainSecretSeal, state RevealedFungible)
                       | revealed (seal XChainBlindSealTxid, state RevealedFungible)

@mnemonic(slogan-change-green)
data AssignVoidStateBlindSealTxPtr : confidential (seal XChainSecretSeal, state VoidState)
                       | confidentialState (seal XChainBlindSealTxPtr, state VoidState)
                       | confidentialSeal (seal XChainSecretSeal, state VoidState)
                       | revealed (seal XChainBlindSealTxPtr, state VoidState)

@mnemonic(classic-cubic-ingrid)
data AssignVoidStateBlindSealTxid : confidential (seal XChainSecretSeal, state VoidState)
                       | confidentialState (seal XChainBlindSealTxid, state VoidState)
                       | confidentialSeal (seal XChainSecretSeal, state VoidState)
                       | revealed (seal XChainBlindSealTxid, state VoidState)

@mnemonic(hunter-hello-retro)
data AssignmentType    : U16

@mnemonic(explain-nato-passage)
data AssignmentWitness : absent ()
                       | present XChainTxid

@mnemonic(granite-history-canvas)
data AssignmentsBlindSealTxPtr : {AssignmentType -> ^ ..0xff TypedAssignsBlindSealTxPtr}

@mnemonic(center-nevada-promise)
data AssignmentsBlindSealTxid : {AssignmentType -> ^ ..0xff TypedAssignsBlindSealTxid}

@mnemonic(delta-member-agenda)
data AttachId          : [Byte ^ 32]

@mnemonic(goblin-accent-number)
data BaseCommitment    : schemaId SchemaId
                       , testnet Std.Bool#laser-madam-maxwell
                       , altLayers1 CommitVerify.StrictHash#cheese-final-locate

@mnemonic(agenda-ivory-blast)
data BlindingFactor    : [Byte ^ 32]

@mnemonic(pizza-natural-cyclone)
data ConcealedAttach   : [Byte ^ 32]

@mnemonic(mirage-invite-newton)
data ConcealedData     : [Byte ^ 32]

@mnemonic(small-melody-empty)
data ConcealedFungible : commitment PedersenCommitment, rangeProof PedersenCommitment

@mnemonic(beast-korea-perfect)
data ContractHistory   : schemaId SchemaId
                       , rootSchemaId SchemaId?
                       , contractId ContractId
                       , global {GlobalStateType -> ^ ..0xff {GlobalOrd -> ^ ..0xffffffff RevealedData}}
                       , rights {OutputAssignmentVoidState ^ ..0xffffffff}
                       , fungibles {OutputAssignmentRevealedValue ^ ..0xffffffff}
                       , data {OutputAssignmentRevealedData ^ ..0xffffffff}
                       , attach {OutputAssignmentRevealedAttach ^ ..0xffffffff}

@mnemonic(alarm-danube-vampire)
data ContractId        : [Byte ^ 32]

@mnemonic(client-major-stamp)
data ContractState     : schema SchemaSchema, history ContractHistory

@mnemonic(diana-archive-liquid)
data DataState         : [Byte]

@mnemonic(cubic-inca-maestro)
data Extension         : ffv Ffv
                       , contractId ContractId
                       , extensionType ExtensionType
                       , metadata Metadata
                       , globals GlobalState
                       , assignments AssignmentsBlindSealTxid
                       , redeemed Redeemed
                       , valencies Valencies

@mnemonic(peace-tiger-elastic)
data ExtensionSchema   : metadata StrictTypes.SemId#cargo-plasma-catalog
                       , globals {GlobalStateType -> ^ ..0xff Occurrences}
                       , redeems {ValencyType ^ ..0xff}
                       , assignments {AssignmentType -> ^ ..0xff Occurrences}
                       , valencies {ValencyType ^ ..0xff}

@mnemonic(mission-salsa-parole)
data ExtensionType     : U16

@mnemonic(silence-motel-toronto)
data Ffv               : U16

@mnemonic(natasha-profit-winter)
data FungibleState     : bits64#8 U64

@mnemonic(profit-bazooka-present)
data FungibleType      : unsigned64Bit#8


@mnemonic(darwin-between-pilot)
data Genesis           : ffv Ffv
                       , schemaId SchemaId
                       , testnet Std.Bool#laser-madam-maxwell
                       , altLayers1 AltLayer1Set
                       , metadata Metadata
                       , globals GlobalState
                       , assignments AssignmentsBlindSealTxid
                       , valencies Valencies

@mnemonic(andrea-amigo-grid)
data GenesisSchema     : metadata StrictTypes.SemId#cargo-plasma-catalog
                       , globals {GlobalStateType -> ^ ..0xff Occurrences}
                       , assignments {AssignmentType -> ^ ..0xff Occurrences}
                       , valencies {ValencyType ^ ..0xff}

@mnemonic(north-llama-empire)
data GlobalOrd         : witnessAnchor WitnessAnchor?, idx U16

@mnemonic(ranger-middle-roman)
data GlobalState       : {GlobalStateType -> ^ ..0xff GlobalValues}

@mnemonic(night-mixer-monaco)
data GlobalStateSchema : semId StrictTypes.SemId#cargo-plasma-catalog, maxItems U16

@mnemonic(seminar-major-tape)
data GlobalStateType   : U16

@mnemonic(bicycle-europe-shampoo)
data GlobalValues      : [RevealedData ^ 1..]

@mnemonic(joseph-price-summer)
data Input             : prevOut Opout, reserved ReservedBytes2

@mnemonic(canada-chicken-analyze)
data InputMap          : {Bitcoin.Vout -> ^ 1.. OpId}

@mnemonic(puzzle-guru-oregano)
data Inputs            : {Input ^ ..0xff}

@mnemonic(light-nelson-brain)
data MediaType         : any#255


@mnemonic(moment-patriot-patron)
data Metadata          : [Byte]

@mnemonic(unicorn-empire-mama)
data Occurrences       : min U16, max U16

@mnemonic(canyon-climax-promo)
data OpCommitment      : ffv Ffv
                       , opType TypeCommitment
                       , metadata CommitVerify.StrictHash#cheese-final-locate
                       , globals CommitVerify.MerkleHash#culture-metro-modular
                       , inputs CommitVerify.MerkleHash#culture-metro-modular
                       , assignments CommitVerify.MerkleHash#culture-metro-modular
                       , redeemed CommitVerify.StrictHash#cheese-final-locate
                       , valencies CommitVerify.StrictHash#cheese-final-locate

@mnemonic(slow-samuel-ceramic)
data OpId              : [Byte ^ 32]

@mnemonic(shallow-match-tokyo)
data Opout             : op OpId
                       , ty AssignmentType
                       , no U16

@mnemonic(think-record-medusa)
data OutputAssignmentRevealedAttach : opout Opout
                       , seal XChainExplicitSealTxid
                       , state RevealedAttach
                       , witness AssignmentWitness

@mnemonic(nectar-nectar-capsule)
data OutputAssignmentRevealedData : opout Opout
                       , seal XChainExplicitSealTxid
                       , state RevealedData
                       , witness AssignmentWitness

@mnemonic(control-boris-motif)
data OutputAssignmentRevealedValue : opout Opout
                       , seal XChainExplicitSealTxid
                       , state RevealedFungible
                       , witness AssignmentWitness

@mnemonic(avatar-beatles-protein)
data OutputAssignmentVoidState : opout Opout
                       , seal XChainExplicitSealTxid
                       , state VoidState
                       , witness AssignmentWitness

@mnemonic(nepal-delta-earth)
data PedersenCommitment : [Byte ^ 33]

@mnemonic(scoop-press-scuba)
data Redeemed          : {ValencyType -> ^ ..0xff OpId}

@mnemonic(pocket-habitat-soviet)
data ReservedBytes2    : [Byte ^ 2]

@mnemonic(cigar-network-event)
data RevealedAttach    : id AttachId
                       , mediaType MediaType
                       , salt U64

@mnemonic(ivory-bogart-stock)
data RevealedData      : value DataState, salt U128

@mnemonic(canal-pagoda-ralph)
data RevealedFungible  : value FungibleState
                       , blinding BlindingFactor
                       , tag AssetTag

@mnemonic(fresh-beatles-empire)
data Schema            : ffv Ffv
                       , subsetOf ()?
                       , globalTypes {GlobalStateType -> ^ ..0xff GlobalStateSchema}
                       , ownedTypes {AssignmentType -> ^ ..0xff StateSchema}
                       , valencyTypes {ValencyType ^ ..0xff}
                       , genesis GenesisSchema
                       , extensions {ExtensionType -> ^ ..0xff ExtensionSchema}
                       , transitions {TransitionType -> ^ ..0xff TransitionSchema}
                       , typeSystem StrictTypes.TypeSystem#panel-data-lazarus
                       , script Script

@mnemonic(garcia-smoke-ozone)
data SchemaId          : [Byte ^ 32]

@mnemonic(heaven-object-august)
data SchemaSchema      : ffv Ffv
                       , subsetOf Schema?
                       , globalTypes {GlobalStateType -> ^ ..0xff GlobalStateSchema}
                       , ownedTypes {AssignmentType -> ^ ..0xff StateSchema}
                       , valencyTypes {ValencyType ^ ..0xff}
                       , genesis GenesisSchema
                       , extensions {ExtensionType -> ^ ..0xff ExtensionSchema}
                       , transitions {TransitionType -> ^ ..0xff TransitionSchema}
                       , typeSystem StrictTypes.TypeSystem#panel-data-lazarus
                       , script Script

@mnemonic(process-media-second)
data Script            : aluVm AluScript

@mnemonic(report-agatha-level)
data StateSchema       : declarative ()
                       | fungible FungibleType
                       | structured StrictTypes.SemId#cargo-plasma-catalog
                       | attachment MediaType

@mnemonic(morph-romeo-float)
data Transition        : ffv Ffv
                       , contractId ContractId
                       , transitionType TransitionType
                       , metadata Metadata
                       , globals GlobalState
                       , inputs Inputs
                       , assignments AssignmentsBlindSealTxPtr
                       , valencies Valencies

@mnemonic(museum-result-logic)
data TransitionBundle  : inputMap InputMap, knownTransitions {OpId -> ^ 1.. Transition}

@mnemonic(fiction-caramel-fractal)
data TransitionSchema  : metadata StrictTypes.SemId#cargo-plasma-catalog
                       , globals {GlobalStateType -> ^ ..0xff Occurrences}
                       , inputs {AssignmentType -> ^ ..0xff Occurrences}
                       , assignments {AssignmentType -> ^ ..0xff Occurrences}
                       , valencies {ValencyType ^ ..0xff}

@mnemonic(puma-joshua-evita)
data TransitionType    : U16

@mnemonic(medusa-amigo-reunion)
data TypeCommitment    : genesis BaseCommitment
                       | transition (ContractId, TransitionType)
                       | extension (ContractId, ExtensionType)

@mnemonic(orchid-season-bishop)
data TypedAssignsBlindSealTxPtr : declarative [AssignVoidStateBlindSealTxPtr]
                       | fungible [AssignRevealedValueBlindSealTxPtr]
                       | structured [AssignRevealedDataBlindSealTxPtr]
                       | attachment#255 [AssignRevealedAttachBlindSealTxPtr]

@mnemonic(rondo-roman-expand)
data TypedAssignsBlindSealTxid : declarative [AssignVoidStateBlindSealTxid]
                       | fungible [AssignRevealedValueBlindSealTxid]
                       | structured [AssignRevealedDataBlindSealTxid]
                       | attachment#255 [AssignRevealedAttachBlindSealTxid]

@mnemonic(andy-mango-brother)
data Valencies         : {ValencyType ^ ..0xff}

@mnemonic(palma-exit-pupil)
data ValencyType       : U16

@mnemonic(nectar-ceramic-driver)
data VoidState         : ()

@mnemonic(henry-prepare-company)
data WitnessAnchor     : witnessOrd WitnessOrd, witnessId XChainTxid

@mnemonic(jacket-fiction-sound)
data WitnessOrd        : onChain WitnessPos
                       | offChain ()

@mnemonic(robert-average-artist)
data WitnessPos        : height U32, timestamp I64

@mnemonic(floor-emotion-riviera)
data XChainAnchorSet   : bitcoin AnchorSet
                       | liquid AnchorSet

@mnemonic(prime-loyal-escort)
data XChainBlindSealTxPtr : bitcoin BPCore.BlindSealTxPtr#austria-icon-waiter
                       | liquid BPCore.BlindSealTxPtr#austria-icon-waiter

@mnemonic(biology-domain-domain)
data XChainBlindSealTxid : bitcoin BPCore.BlindSealTxid#kimono-golf-price
                       | liquid BPCore.BlindSealTxid#kimono-golf-price

@mnemonic(ozone-quick-hippie)
data XChainExplicitSealTxid : bitcoin BPCore.ExplicitSealTxid#antenna-darwin-emotion
                       | liquid BPCore.ExplicitSealTxid#antenna-darwin-emotion

@mnemonic(palace-random-taxi)
data XChainSecretSeal  : bitcoin BPCore.SecretSeal#santana-domingo-needle
                       | liquid BPCore.SecretSeal#santana-domingo-needle

@mnemonic(cubic-museum-lemon)
data XChainTxid        : bitcoin Bitcoin.Txid#cowboy-diego-betty
                       | liquid Bitcoin.Txid#cowboy-diego-betty


